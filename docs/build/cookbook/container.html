

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Container usage: Dependency Injection Container &mdash; Dependency Injection Container v1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Dependency Injection Container v1.0.0 documentation" href="../index.html"/>
        <link rel="next" title="Contributing" href="../manual/contrib.html"/>
        <link rel="prev" title="Definitions" href="definitions.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Dependency Injection Container
          

          
          </a>

          
            
            
              <div class="version">
                v1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../manual/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Container usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#constructor-injection">Constructor injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setter-injection">Setter injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#property-injection">Property injection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../manual/contrib.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Dependency Injection Container</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Container usage: Dependency Injection Container</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/slickframework/di/blob/master/doc/cookbook/container.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="container-usage">
<h1>Container usage<a class="headerlink" href="#container-usage" title="Permalink to this headline">¶</a></h1>
<p>Now that we have defined all of our dependencies its time to create a container
that will use them.</p>
<p>Even though <code class="docutils literal"><span class="pre">Container</span></code> can be instantiated as normal PHP objects do, it is
advisable to use the <code class="docutils literal"><span class="pre">ContainerBuilder</span></code> factory to do so. It translates the
definitions file into <code class="docutils literal"><span class="pre">DefinitionInterface</span></code> objects that dependency container
uses to create dependencies. It also chains all the created container so that if
you try to get an entry it will search over all containers in the chain. This
is a very handy feature if you want, for example, to create a package that you
will reuse in your applications and in that package you define a container with
default dependencies and later on your application also defines a dependency
container. Definitions can be overridden and the entries from your package
are also available in your application container.</p>
<p>Now lets create our container:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Slick\Di\ContainerBuilder</span><span class="p">;</span>

<span class="nv">$container</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">ContainerBuilder</span><span class="p">(</span><span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/services.php&#39;</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">getContainer</span><span class="p">();</span>
</pre></div>
</div>
<p>That&#8217;s it! We now have a new created dependency container ready to create objects
and inject their dependencies.</p>
<div class="section" id="constructor-injection">
<h2>Constructor injection<a class="headerlink" href="#constructor-injection" title="Permalink to this headline">¶</a></h2>
<p>Consider the following class:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Car</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @var Engine</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$engine</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">Engine</span> <span class="nv">$engine</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span> <span class="o">=</span> <span class="nv">$engine</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now lets create a new <code class="docutils literal"><span class="pre">Car</span></code> using our dependency container:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="nv">$myCar</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">Car</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">As a rule of thumb, always use type hint in your constructor. This will make
your code more readable, bug free and easy to instantiate with the
dependency container.</p>
</div>
<p>The dependency container will look to constructor arguments and search for type
matches in the dependencies collection he holds and will inject those
dependencies on the requested object instance.</p>
</div>
<div class="section" id="setter-injection">
<h2>Setter injection<a class="headerlink" href="#setter-injection" title="Permalink to this headline">¶</a></h2>
<p>When creating objects with containers, be aware that the container will also
look for methods like <code class="docutils literal"><span class="pre">set&lt;VarName&gt;(VarType</span> <span class="pre">$var)</span></code> and if it has a matching
dependency it will use that method to inject that dependency:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Car</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @var Engine</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$engine</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">setEngine</span><span class="p">(</span><span class="nx">Engine</span> <span class="nv">$engine</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span> <span class="o">=</span> <span class="nv">$engine</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By calling the container to create your car object like:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="nv">$myCar</span> <span class="o">=</span> <span class="nv">$container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">Car</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">Car::$engine</span></code> will be inject using the setter method.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>When creating objects with a container if you have a setter but there is no
known dependency in the container collection, it will not fail because the
container only injects dependencies that he knows of.</p>
<p class="last">In the other hand if you have dependencies on your constructor the object
creation will fail due to missing arguments.</p>
</div>
</div>
<div class="section" id="property-injection">
<h2>Property injection<a class="headerlink" href="#property-injection" title="Permalink to this headline">¶</a></h2>
<p>In property injection we will use the annotation <code class="docutils literal"><span class="pre">&#64;inject</span></code> to tell the
container what to inject:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Car</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @inject</span>
<span class="sd">     * @var Engine</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$engine</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the example above the container will use the <code class="docutils literal"><span class="pre">&#64;var</span></code> annotation to determine
the dependency to inject:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Car</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @inject car.config</span>
<span class="sd">     * @var array</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$config</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;inject</span></code> annotation accepts an argument with the entry name that the container
should use to determine the dependency. In the above example, config array was
stored with car.config key and will be injected in <code class="docutils literal"><span class="pre">Car</span></code> creation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To skip dependency injection on methods or properties you need to set
<code class="docutils literal"><span class="pre">&#64;ignoreInject</span></code> annotation. This annotation tells dependency container to
ignore the automatic dependency injection on public properties or public
methods. This annotation does not work with constructor methods.</p>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">By using the <code class="docutils literal"><span class="pre">&#64;inject</span></code> annotation you are explicitly telling the container
to inject a dependency. If no dependency is found for the provided key or
type an exception will be thrown telling you that the container cannot
inject something you said that he has to.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../manual/contrib.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="definitions.html" class="btn btn-neutral" title="Definitions" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Slick Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>